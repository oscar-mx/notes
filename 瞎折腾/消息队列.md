## 消息队列

### 什么是消息队列？
> 消息队列，一般我们会简称它为MQ(Message Queue)，字面意思...

队列(Queue)应该都知道，一种先进先出的线性表，在一端进行插入操作，而在另一端进行删除。
消息队列可以简单理解为：**把要传输的数据放在队列中。**

- 把数据放到消息队列叫做生产者
- 从消息队列里边取数据叫做消费者

### 为什么要用消息队列？
简单概括为六个字：解耦、异步、削峰

#### 解耦

假设目前有一个A服务，可以产生datas。
然后有B和C要获取A产生的datas，此时需要修改A的代码传给B和C；如果将来有D接入，A还需要修改代码，过于麻烦！

A将datas写入消息队列，需要消息的系统自己从消息队列中订阅，从而A不需要做任何修改。

这样一来，就达到了解耦的效果。


#### 异步
假设目前有一个A服务，可以产生datas，耗时50ms。
传输给B的接口需要100ms，传输给C的接口需要200ms，传输给D的接口需要300ms。那么这次请求就需要50+100+200+300，业务逻辑以同步的方式运行太耗费时间。

A将datas写入消息队列，然后就直接返回了，其他系统的业务逻辑以异步的方式运行，从消息队列那数据，加快响应速度。
#### 削峰
抢购/秒杀等业务并发量大的时候，所有的请求直接怼到数据库，容易造成系统崩溃。

系统A慢慢的按照数据库能处理的并发量，从消息队列中慢慢拉取消息。在生产中，这样就不会把整个系统给搞崩。

### 消息队列注意点

#### 高可用
消息队列不能是单机的。如果是单机的消息队列，万一这台机器挂了，那我们整个系统几乎就是不可用了。所以，当我们项目中使用消息队列，都是得集群/分布式的

#### 数据可靠性
- 数据丢失问题

### 消息队列技术选型
[该如何选择消息队列？](https://zhuanlan.zhihu.com/p/86812691)

[Redis高级特性之Pub/Sub与Stream](https://cloud.tencent.com/developer/article/1456457)